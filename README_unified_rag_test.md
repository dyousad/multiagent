# ç»Ÿä¸€RAGå¢å¼ºæµ‹è¯•ç³»ç»Ÿ

è¯¥ç³»ç»Ÿå°†æ‰€æœ‰æµ‹è¯•å’Œè¿è¡Œè„šæœ¬æ•´åˆä¸ºä¸€ä¸ªç»Ÿä¸€çš„æµ‹è¯•è„šæœ¬ï¼Œé»˜è®¤ä½¿ç”¨å¤æ‚æ¨ç†ï¼ˆæŸ¥è¯¢æ‰©å±•+å¤šè·³æ£€ç´¢+è´¨é‡è¿‡æ»¤ï¼‰ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹

### ä½¿ç”¨Shellè„šæœ¬ï¼ˆæ¨èï¼‰
```bash
# æ ‡å‡†æµ‹è¯•ï¼ˆ5ä¸ªé—®é¢˜ï¼Œçº¦4åˆ†é’Ÿï¼‰
./run_unified_test.sh

# å¿«é€Ÿæµ‹è¯•ï¼ˆ3ä¸ªé—®é¢˜ï¼Œçº¦2åˆ†é’Ÿï¼‰
./run_unified_test.sh quick

# å…¨é¢æµ‹è¯•ï¼ˆ7ä¸ªé—®é¢˜ï¼Œçº¦6åˆ†é’Ÿï¼‰
./run_unified_test.sh comprehensive

# ä¸ä¸åŸºçº¿æ¯”è¾ƒï¼ˆæ›´å¿«æ‰§è¡Œï¼‰
./run_unified_test.sh quick --no-baseline

# ä½¿ç”¨ä¸åŒæ¨¡å‹
./run_unified_test.sh quick --model "gpt-4"
```

### ç›´æ¥ä½¿ç”¨Pythonè„šæœ¬
```bash
# æ ‡å‡†æµ‹è¯•
conda run -n vlm-anchor python3 unified_rag_test.py

# å¿«é€Ÿæµ‹è¯•ï¼Œä¸ä¸åŸºçº¿æ¯”è¾ƒ
conda run -n vlm-anchor python3 unified_rag_test.py --mode quick --no-baseline

# å…¨é¢æµ‹è¯•
conda run -n vlm-anchor python3 unified_rag_test.py --mode comprehensive
```

## ğŸ§  é»˜è®¤é…ç½®ï¼ˆå¤æ‚æ¨ç†ï¼‰

ç»Ÿä¸€è„šæœ¬é»˜è®¤å¯ç”¨æ‰€æœ‰å¢å¼ºåŠŸèƒ½ï¼š

- âœ… **æŸ¥è¯¢æ‰©å±•**: è‡ªåŠ¨æ‰©å±•æŸ¥è¯¢ä»¥æé«˜æ£€ç´¢è¦†ç›–ç‡
- âœ… **å¤šè·³æ£€ç´¢**: æœ€å¤š3è·³çš„å¤æ‚æ¨ç†é“¾
- âœ… **è´¨é‡è¿‡æ»¤**: æ™ºèƒ½è¿‡æ»¤ä½è´¨é‡è¯æ®

### é…ç½®è¯¦æƒ…
```python
# å¤šè·³æ£€ç´¢é…ç½®
MultiHopConfig(
    max_hops=3,                    # æœ€å¤š3è·³
    evidence_per_hop=4,            # æ¯è·³4ä¸ªè¯æ®
    min_confidence_threshold=0.25,  # æœ€ä½ç½®ä¿¡åº¦é˜ˆå€¼
    entity_overlap_threshold=0.15,  # å®ä½“é‡å é˜ˆå€¼
    enable_backward_validation=True # åå‘éªŒè¯
)

# è´¨é‡è¿‡æ»¤é…ç½®
FilterConfig(
    min_content_score=0.25,         # æœ€ä½å†…å®¹è´¨é‡åˆ†æ•°
    min_relevance_score=0.3,        # æœ€ä½ç›¸å…³æ€§åˆ†æ•°
    enable_entity_consistency=True,  # å®ä½“ä¸€è‡´æ€§æ£€æŸ¥
    enable_temporal_filtering=True,  # æ—¶é—´ä¸€è‡´æ€§è¿‡æ»¤
    enable_contradiction_detection=True # çŸ›ç›¾æ£€æµ‹
)
```

## ğŸ“Š æµ‹è¯•æ¨¡å¼

| æ¨¡å¼ | é—®é¢˜æ•°é‡ | é¢„è®¡æ—¶é—´ | é€‚ç”¨åœºæ™¯ |
|------|----------|----------|----------|
| `quick` | 3 | ~2åˆ†é’Ÿ | å¿«é€ŸéªŒè¯åŠŸèƒ½ |
| `standard` | 5 | ~4åˆ†é’Ÿ | æ ‡å‡†æ€§èƒ½æµ‹è¯• |
| `comprehensive` | 7 | ~6åˆ†é’Ÿ | å…¨é¢è¯„ä¼° |

## ğŸ“ ç»“æœæ–‡ä»¶

æµ‹è¯•ç»“æœè‡ªåŠ¨ä¿å­˜åœ¨ `results/unified_rag_test/` ç›®å½•ï¼š

```
results/unified_rag_test/
â”œâ”€â”€ unified_test_results_20251119_154601_quick.json
â”œâ”€â”€ unified_test_results_20251119_154410_quick_no_baseline.json
â””â”€â”€ ...
```

ç»“æœæ–‡ä»¶åŒ…å«ï¼š
- è¯¦ç»†çš„æ£€ç´¢ç»Ÿè®¡ä¿¡æ¯
- å¤šè·³æ¨ç†è·¯å¾„
- è´¨é‡è¯„åˆ†åˆ†å¸ƒ
- æ€§èƒ½å¯¹æ¯”æ•°æ®

## ğŸ”§ ç¯å¢ƒè¦æ±‚

- **Condaç¯å¢ƒ**: `vlm-anchor`
- **Python**: 3.9+
- **ä¾èµ–**: å·²åœ¨ç¯å¢ƒä¸­å®‰è£…æ‰€æœ‰å¿…è¦çš„åŒ…

## ğŸ“ˆ æ€§èƒ½æŒ‡æ ‡

ç³»ç»Ÿä¼šè‡ªåŠ¨æŠ¥å‘Šï¼š

### å¤æ‚æ¨ç†æ€§èƒ½
- å¹³å‡è¯æ®æ•°é‡
- å¹³å‡è·³æ•°
- å¹³å‡è´¨é‡åˆ†æ•°
- å¹³å‡æ‰§è¡Œæ—¶é—´

### ä¸åŸºçº¿å¯¹æ¯”
- è¯æ®å¢ç›Š
- æ”¹è¿›ç™¾åˆ†æ¯”
- æ—¶é—´å¼€é”€

## ğŸ’¡ ä½¿ç”¨å»ºè®®

### æ—¥å¸¸å¼€å‘æµ‹è¯•
```bash
./run_unified_test.sh quick --no-baseline
```

### æ€§èƒ½è¯„ä¼°
```bash
./run_unified_test.sh standard
```

### å…¨é¢éªŒè¯
```bash
./run_unified_test.sh comprehensive
```

## ğŸ†š ä¸åŸå§‹æµ‹è¯•æ–‡ä»¶çš„å¯¹æ¯”

### åŸå§‹æ–‡ä»¶ç»“æ„
- `test_query_expansion.py` - æŸ¥è¯¢æ‰©å±•æµ‹è¯•
- `test_multi_hop.py` - å¤šè·³æ£€ç´¢æµ‹è¯•
- `test_comprehensive_rag.py` - ç»¼åˆæµ‹è¯•
- `run_rag_enhanced.sh` - è¿è¡Œè„šæœ¬
- ç­‰å¤šä¸ªåˆ†æ•£çš„æµ‹è¯•æ–‡ä»¶

### ç»Ÿä¸€åçš„ç»“æ„
- `unified_rag_test.py` - å•ä¸€Pythonè„šæœ¬åŒ…å«æ‰€æœ‰åŠŸèƒ½
- `run_unified_test.sh` - ç®€åŒ–çš„ShellåŒ…è£…å™¨

### ä¼˜åŠ¿
1. **ç®€åŒ–çš„æ¥å£**: å•ä¸€å‘½ä»¤è¡Œç•Œé¢
2. **é»˜è®¤æœ€ä½³é…ç½®**: å¤æ‚æ¨ç†ä½œä¸ºé»˜è®¤è®¾ç½®
3. **ç»Ÿä¸€çš„ç»“æœæ ¼å¼**: ä¸€è‡´çš„è¾“å‡ºå’Œä¿å­˜æ ¼å¼
4. **æ›´å¥½çš„ç”¨æˆ·ä½“éªŒ**: æ¸…æ™°çš„çŠ¶æ€æŒ‡ç¤ºå’Œè¿›åº¦æŠ¥å‘Š

## ğŸ” æ•…éšœæ’é™¤

### ç¯å¢ƒé—®é¢˜
```bash
# æ£€æŸ¥condaç¯å¢ƒ
conda env list

# æ¿€æ´»ç¯å¢ƒå¹¶æ£€æŸ¥ä¾èµ–
conda activate vlm-anchor
pip list | grep -E "(torch|transformers|faiss)"
```

### æƒé™é—®é¢˜
```bash
chmod +x run_unified_test.sh
```

### æ¨¡å—å¯¼å…¥é—®é¢˜
ç¡®ä¿åœ¨æ­£ç¡®çš„ç›®å½•ä¸­è¿è¡Œè„šæœ¬ï¼Œæˆ–æ£€æŸ¥Pythonè·¯å¾„è®¾ç½®ã€‚